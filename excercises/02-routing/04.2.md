---
time: 10 min
---

# Guards / Guard with state

- Create a service holding the login state if the user is logged in
- Create a guard function (is-user-authenticated.guard.ts) as CanMatchFn to read that state by injecting that service and allow access on the books routes


## Hints

<details>
<summary>Tips</summary>

**UserStateService**
```ts
@Injectable({
  providedIn: 'root'
})
export class UserStateService {
  //...
}
```

**Inject the Servie in the guard**
```ts
import { CanMatchFn } from '@angular/router';
import { UserStateService } from './user-state.service';
import { inject } from '@angular/core';

export const isUserAuthenticatedGuardFn: CanMatchFn = (route, state) => {
  const service = inject(UserStateService);

  return service.isLoggedIn;
};
```

**AppRoutes**
```ts
{
  path: 'books',
  //...
  canMatch: [
  isUserAuthenticatedGuardFn
  ]
}
```

</details>

**Solution Tag**: solve--build-a-can-match-guard-with-state
